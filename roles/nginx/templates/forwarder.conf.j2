# TCP stream forwarder for {{ domain }}
# Managed by Ansible - DO NOT EDIT MANUALLY
# Transparent TCP proxy (no protocol inspection)

{% if config.http | default(true) %}
server {
    listen 80;
    # Using variable forces runtime DNS resolution (avoids startup failures)
    set $upstream_http {{ config.forward_to }};
    proxy_pass $upstream_http:80;
}
{% endif %}

{% if config.https | default(true) %}
server {
    listen 443;
    # Using variable forces runtime DNS resolution (avoids startup failures)
    set $upstream_https {{ config.forward_to }};
    proxy_pass $upstream_https:443;
}
{% endif %}
